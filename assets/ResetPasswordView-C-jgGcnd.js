import{c as j,o as N,s as R,p as B,u as L,_ as q,t as A,a as $}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-CkWQ3NDV.js";import{d as F,a as I,u as M,l as x,q as U,s as z,f as D,g as E,w as l,e,c as w,b as r,i as o,t,k as d,r as W,h as Z,j as b,o as c}from"./index-ZcRV7itf.js";import{_ as k}from"./PasswordInput.vue_vue_type_script_setup_true_lang-B7vgH7hf.js";import{C as G}from"./circle-check-B6gM7trf.js";const H=j("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),J={key:0,class:"text-center space-y-6"},K={class:"flex justify-center"},O={class:"w-16 h-16 rounded-full bg-warm-error/10 flex items-center justify-center"},Q={class:"space-y-2"},X={class:"text-xl font-semibold text-warm-text"},Y={key:1,class:"text-center space-y-6"},ee={class:"flex justify-center"},se={class:"w-16 h-16 rounded-full bg-warm-success/10 flex items-center justify-center"},re={class:"space-y-2"},te={class:"text-xl font-semibold text-warm-text"},oe={class:"text-warm-text-secondary leading-relaxed"},ae={key:0,class:"bg-warm-error/10 border border-warm-error text-warm-error px-4 py-3 rounded-xl text-sm animate-shake"},le={class:"text-center text-sm text-warm-text-secondary"},me=F({__name:"ResetPasswordView",setup(ne){const T=D(),V=z(),u=I(),{t:s}=M(),m=x(null),_=x(!1),y=x(!1),S=N({password:B.regex(/[A-Za-z]/,"密码必须包含至少一个字母").regex(/[0-9]/,"密码必须包含至少一个数字"),confirmPassword:R()}).refine(n=>n.password===n.confirmPassword,{message:"两次输入的密码不一致",path:["confirmPassword"]}),{handleSubmit:C,errors:g,defineField:v}=L({validationSchema:A(S)}),[f]=v("password"),[p]=v("confirmPassword");U(()=>{m.value=V.query.token,m.value||(y.value=!0)});const P=C(async n=>{if(!m.value)return;await u.resetPassword(m.value,n.password)&&(_.value=!0,setTimeout(()=>{T.push("/login")},3e3))});return(n,a)=>{const h=W("router-link");return c(),E(q,{title:e(s)("resetPassword.title")},{default:l(()=>[y.value?(c(),w("div",J,[r("div",K,[r("div",O,[o(e(H),{class:"w-8 h-8 text-warm-error"})])]),r("div",Q,[r("h3",X,t(e(s)("resetPassword.invalidToken")),1)]),o(h,{to:"/login",class:"inline-block w-full px-8 py-3 rounded-xl font-medium transition-all duration-200 bg-warm-primary text-white hover:bg-warm-primary-hover"},{default:l(()=>[d(t(e(s)("resetPassword.goToLogin")),1)]),_:1})])):_.value?(c(),w("div",Y,[r("div",ee,[r("div",se,[o(e(G),{class:"w-8 h-8 text-warm-success"})])]),r("div",re,[r("h3",te,t(e(s)("resetPassword.successTitle")),1),r("p",oe,t(e(s)("resetPassword.successMessage")),1)]),o(h,{to:"/login",class:"inline-block w-full px-8 py-3 rounded-xl font-medium transition-all duration-200 bg-warm-primary text-white hover:bg-warm-primary-hover"},{default:l(()=>[d(t(e(s)("resetPassword.goToLogin")),1)]),_:1})])):(c(),w("form",{key:2,class:"space-y-6",onSubmit:a[2]||(a[2]=(...i)=>e(P)&&e(P)(...i))},[e(u).error?(c(),w("div",ae,t(e(u).error),1)):Z("",!0),o(k,{modelValue:e(f),"onUpdate:modelValue":a[0]||(a[0]=i=>b(f)?f.value=i:null),label:e(s)("resetPassword.newPassword"),placeholder:e(s)("resetPassword.newPasswordPlaceholder"),error:e(g).password,"show-strength":""},null,8,["modelValue","label","placeholder","error"]),o(k,{modelValue:e(p),"onUpdate:modelValue":a[1]||(a[1]=i=>b(p)?p.value=i:null),label:e(s)("resetPassword.confirmNewPassword"),placeholder:e(s)("resetPassword.confirmNewPasswordPlaceholder"),error:e(g).confirmPassword},null,8,["modelValue","label","placeholder","error"]),o($,{loading:e(u).loading,"full-width":""},{loading:l(()=>[d(t(e(s)("resetPassword.submitting")),1)]),default:l(()=>[d(" "+t(e(s)("resetPassword.submit")),1)]),_:1},8,["loading"]),r("p",le,[o(h,{to:"/login",class:"text-warm-primary hover:text-warm-primary-hover font-medium transition-colors"},{default:l(()=>[d(t(e(s)("forgotPassword.backToLogin")),1)]),_:1})])],32))]),_:1},8,["title"])}}});export{me as default};
